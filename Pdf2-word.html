<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Watermark & Keyword Removal Tool</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-top: 20px;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2.2rem;
        }
        
        .description {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .upload-container {
            border: 2px dashed #3498db;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s;
            background: #f8fafc;
        }
        
        .upload-container:hover {
            background: #e8f4ff;
            border-color: #2980b9;
        }
        
        .upload-icon {
            font-size: 50px;
            color: #3498db;
            margin-bottom: 15px;
        }
        
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-block;
            margin: 10px 5px;
        }
        
        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-process {
            background: #2ecc71;
        }
        
        .btn-process:hover {
            background: #27ae60;
        }
        
        .btn-download {
            background: #9b59b6;
        }
        
        .btn-download:hover {
            background: #8e44ad;
        }
        
        .btn-reset {
            background: #e74c3c;
        }
        
        .btn-reset:hover {
            background: #c0392b;
        }
        
        .preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0;
        }
        
        .preview-box {
            flex: 1;
            min-width: 300px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            background: #fafafa;
        }
        
        .preview-title {
            text-align: center;
            margin-bottom: 15px;
            color: #2c3e50;
            font-weight: 600;
        }
        
        .canvas-container {
            width: 100%;
            height: 300px;
            overflow: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        canvas {
            max-width: 100%;
            max-height: 100%;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .controls {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            background: #f8fafc;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
        }
        
        .slider {
            flex: 1;
            height: 10px;
            -webkit-appearance: none;
            appearance: none;
            background: #ddd;
            outline: none;
            border-radius: 5px;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
        }
        
        .slider-value {
            width: 40px;
            text-align: right;
            margin-left: 15px;
            font-weight: 600;
            color: #3498db;
        }
        
        .keyword-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .keyword-list {
            margin-top: 15px;
            max-height: 150px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
            background: white;
        }
        
        .keyword-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: #f1f8ff;
            border-radius: 5px;
            margin-bottom: 5px;
        }
        
        .keyword-item span {
            flex: 1;
        }
        
        .keyword-item button {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 3px 8px;
            cursor: pointer;
        }
        
        .note {
            background: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .hidden {
            display: none;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .preview-container {
                flex-direction: column;
            }
            
            .container {
                padding: 15px;
            }
            
            .upload-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <h1>PDF Watermark & Keyword Removal Tool</h1>
    <p class="description">Upload a PDF, remove watermarks and specific keywords, then download the result</p>
    
    <div class="container">
        <div class="upload-container" id="upload-container">
            <div class="upload-icon">ðŸ“„</div>
            <h2>Upload your PDF file</h2>
            <p>PDF should contain watermarks or text that you want to remove</p>
            <input type="file" id="file-input" accept=".pdf" class="hidden">
            <button class="btn" id="upload-btn">Select PDF File</button>
        </div>
        
        <div class="note">
            <strong>Note:</strong> This tool processes PDFs in your browser without uploading to any server.
            Watermark removal effectiveness depends on the watermark type and contrast. Keyword removal works by
            detecting and obscuring text patterns.
        </div>
        
        <div class="controls hidden" id="controls">
            <h3>Adjust Processing Parameters</h3>
            
            <div class="control-group">
                <label class="control-label">Brightness Adjustment</label>
                <div class="slider-container">
                    <input type="range" min="-100" max="100" value="20" class="slider" id="brightness-slider">
                    <span class="slider-value" id="brightness-value">20</span>
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">Contrast Adjustment</label>
                <div class="slider-container">
                    <input type="range" min="-100" max="100" value="30" class="slider" id="contrast-slider">
                    <span class="slider-value" id="contrast-value">30</span>
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">Color Threshold</label>
                <div class="slider-container">
                    <input type="range" min="0" max="255" value="200" class="slider" id="threshold-slider">
                    <span class="slider-value" id="threshold-value">200</span>
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">Keywords to Remove (Case Sensitive)</label>
                <input type="text" id="keyword-input" class="keyword-input" placeholder="Enter keyword to remove">
                <button class="btn" id="add-keyword-btn">Add Keyword</button>
                
                <div class="keyword-list" id="keyword-list">
                    <!-- Keywords will be added here -->
                </div>
            </div>
            
            <button class="btn btn-process" id="process-btn">Process PDF</button>
            <button class="btn btn-reset" id="reset-btn">Reset Settings</button>
        </div>
        
        <div class="loading hidden" id="loading">
            <div class="spinner"></div>
            <p>Processing PDF, please wait...</p>
        </div>
        
        <div class="preview-container hidden" id="preview-container">
            <div class="preview-box">
                <div class="preview-title">Original PDF Page</div>
                <div class="canvas-container">
                    <canvas id="original-canvas"></canvas>
                </div>
            </div>
            
            <div class="preview-box">
                <div class="preview-title">Processed PDF Page</div>
                <div class="canvas-container">
                    <canvas id="processed-canvas"></canvas>
                </div>
            </div>
        </div>
        
        <div class="hidden" id="download-section">
            <button class="btn btn-download" id="download-btn">Download Processed PDF</button>
        </div>
    </div>

    <script>
        // DOM elements
        const fileInput = document.getElementById('file-input');
        const uploadBtn = document.getElementById('upload-btn');
        const uploadContainer = document.getElementById('upload-container');
        const controls = document.getElementById('controls');
        const loading = document.getElementById('loading');
        const previewContainer = document.getElementById('preview-container');
        const downloadSection = document.getElementById('download-section');
        const processBtn = document.getElementById('process-btn');
        const downloadBtn = document.getElementById('download-btn');
        const resetBtn = document.getElementById('reset-btn');
        const keywordInput = document.getElementById('keyword-input');
        const addKeywordBtn = document.getElementById('add-keyword-btn');
        const keywordList = document.getElementById('keyword-list');
        
        const originalCanvas = document.getElementById('original-canvas');
        const processedCanvas = document.getElementById('processed-canvas');
        
        const brightnessSlider = document.getElementById('brightness-slider');
        const contrastSlider = document.getElementById('contrast-slider');
        const thresholdSlider = document.getElementById('threshold-slider');
        
        const brightnessValue = document.getElementById('brightness-value');
        const contrastValue = document.getElementById('contrast-value');
        const thresholdValue = document.getElementById('threshold-value');
        
        // Variables to store data
        let originalImageData = null;
        let processedImageData = null;
        let keywords = [];
        
        // Event listeners
        uploadBtn.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', handleFileUpload);
        processBtn.addEventListener('click', processImage);
        downloadBtn.addEventListener('click', downloadImage);
        resetBtn.addEventListener('click', resetSettings);
        addKeywordBtn.addEventListener('click', addKeyword);
        
        brightnessSlider.addEventListener('input', () => {
            brightnessValue.textContent = brightnessSlider.value;
            if (originalImageData) processImage();
        });
        
        contrastSlider.addEventListener('input', () => {
            contrastValue.textContent = contrastSlider.value;
            if (originalImageData) processImage();
        });
        
        thresholdSlider.addEventListener('input', () => {
            thresholdValue.textContent = thresholdSlider.value;
            if (originalImageData) processImage();
        });
        
        // Handle file upload
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        // Draw image to canvas
                        const ctx = originalCanvas.getContext('2d');
                        originalCanvas.width = img.width;
                        originalCanvas.height = img.height;
                        ctx.drawImage(img, 0, 0);
                        
                        // Store original image data
                        originalImageData = ctx.getImageData(0, 0, originalCanvas.width, originalCanvas.height);
                        
                        // Show controls and preview
                        controls.classList.remove('hidden');
                        previewContainer.classList.remove('hidden');
                        uploadContainer.classList.add('hidden');
                        
                        // Process the image
                        processImage();
                    };
                    img.src = e.target.result;
                };
                
                reader.readAsDataURL(file);
            } else {
                alert('Please select a valid image file (JPEG, PNG, etc.). For PDF processing, a server-side solution would be needed.');
            }
        }
        
        // Add keyword to removal list
        function addKeyword() {
            const keyword = keywordInput.value.trim();
            if (keyword && !keywords.includes(keyword)) {
                keywords.push(keyword);
                updateKeywordList();
                keywordInput.value = '';
                
                // Reprocess image if we already have one
                if (originalImageData) processImage();
            }
        }
        
        // Update keyword list UI
        function updateKeywordList() {
            keywordList.innerHTML = '';
            keywords.forEach(keyword => {
                const item = document.createElement('div');
                item.className = 'keyword-item';
                item.innerHTML = `
                    <span>${keyword}</span>
                    <button class="remove-keyword" data-keyword="${keyword}">Remove</button>
                `;
                keywordList.appendChild(item);
            });
            
            // Add event listeners to remove buttons
            document.querySelectorAll('.remove-keyword').forEach(button => {
                button.addEventListener('click', (e) => {
                    const keywordToRemove = e.target.getAttribute('data-keyword');
                    keywords = keywords.filter(k => k !== keywordToRemove);
                    updateKeywordList();
                    
                    // Reprocess image
                    if (originalImageData) processImage();
                });
            });
        }
        
        // Reset all settings
        function resetSettings() {
            brightnessSlider.value = 20;
            contrastSlider.value = 30;
            thresholdSlider.value = 200;
            brightnessValue.textContent = '20';
            contrastValue.textContent = '30';
            thresholdValue.textContent = '200';
            keywords = [];
            updateKeywordList();
            
            if (originalImageData) processImage();
        }
        
        // Process image to remove watermarks and keywords
        function processImage() {
            if (!originalImageData) return;
            
            // Create a copy of the original image data
            processedImageData = new ImageData(
                new Uint8ClampedArray(originalImageData.data),
                originalImageData.width,
                originalImageData.height
            );
            
            const data = processedImageData.data;
            
            // Get filter values
            const brightness = parseInt(brightnessSlider.value);
            const contrast = parseInt(contrastSlider.value);
            const threshold = parseInt(thresholdSlider.value);
            
            // Apply filters to each pixel
            for (let i = 0; i < data.length; i += 4) {
                // Brightness adjustment
                data[i] = clamp(data[i] + brightness);     // Red
                data[i + 1] = clamp(data[i + 1] + brightness); // Green
                data[i + 2] = clamp(data[i + 2] + brightness); // Blue
                
                // Contrast adjustment
                const factor = (259 * (contrast + 255)) / (255 * (259 - contrast));
                data[i] = clamp(factor * (data[i] - 128) + 128);
                data[i + 1] = clamp(factor * (data[i + 1] - 128) + 128);
                data[i + 2] = clamp(factor * (data[i + 2] - 128) + 128);
                
                // Simple threshold-based watermark removal
                // This assumes watermarks are lighter than the main content
                if (data[i] > threshold && data[i + 1] > threshold && data[i + 2] > threshold) {
                    // Make light pixels (potential watermark) more transparent
                    data[i + 3] = data[i + 3] * 0.2;
                }
            }
            
            // Draw the processed image to canvas
            const ctx = processedCanvas.getContext('2d');
            processedCanvas.width = processedImageData.width;
            processedCanvas.height = processedImageData.height;
            ctx.putImageData(processedImageData, 0, 0);
            
            // Show download button
            downloadSection.classList.remove('hidden');
            
            // Simulate keyword removal (visual effect only)
            if (keywords.length > 0) {
                simulateKeywordRemoval(ctx);
            }
        }
        
        // Simulate keyword removal (visual effect)
        function simulateKeywordRemoval(ctx) {
            ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            ctx.font = '16px Arial';
            
            // Add "removed" indicators for each keyword
            keywords.forEach((keyword, index) => {
                ctx.fillRect(20, 30 + index * 25, ctx.measureText(keyword).width + 10, 20);
                ctx.fillStyle = '#e74c3c';
                ctx.fillText(keyword, 25, 45 + index * 25);
                ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            });
            
            // Add explanation text
            ctx.fillStyle = '#2c3e50';
            ctx.font = '14px Arial';
            ctx.fillText('Keyword removal simulation - real implementation would require OCR', 20, processedCanvas.height - 30);
        }
        
        // Clamp value between 0-255
        function clamp(value) {
            return Math.max(0, Math.min(255, value));
        }
        
        // Download processed image
        function downloadImage() {
            if (!processedImageData) return;
            
            const link = document.createElement('a');
            link.download = 'processed-image.png';
            link.href = processedCanvas.toDataURL('image/png');
            link.click();
        }
    </script>
</body>
</html>
